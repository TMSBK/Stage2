let restaurant;var map;window.initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.map=new google.maps.Map(document.getElementById("map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.map))})});let toggleButton=document.getElementById("mapToggle"),gMap=document.getElementById("map-container");gMap.style.display="none",toggleButton.addEventListener("click",e=>{e.preventDefault(),"none"===gMap.style.display?(toggleButton.innerHTML="Hide Map",gMap.style.display="block"):(toggleButton.innerHTML="Show Map",gMap.style.display="none")}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fetchReviewsFromURL=(e=>{if(self.reviews)return void e(null,self.reviews);const t=getParameterByName("id");t?DBHelper.fetchReviewsByRestaurantId(t,(e,t)=>{self.reviews=t,t?fillReviewsHTML():fillReviewsHTML(null)}):(error="No review id in URL",e(error,null))});let svg=document.getElementById("svg");fillRestaurantHTML=((e=self.restaurant)=>{const t=document.getElementById("restaurant-name");t.innerHTML=e.name,t.classList.add("focus");const n=document.getElementById("restaurant-address");n.innerHTML=e.address,n.classList.add("focus"),n.setAttribute("aria-label","address of the restaurant "+e.address);const a=document.getElementById("restaurant-img");a.className="restaurant-img",a.alt=`${e.name}`,a.src=DBHelper.imageUrlForRestaurant(e),a.srcset=`/minimizedImages/${e.photo_large_1x} 1x,\n                  /minimizedImages/${e.photo_2x} 2x`,document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,"false"===e.is_favorite?svg.innerHTML='<svg id="fav" xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 24 24"><path d="M12 9.229c.234-1.12 1.547-6.229 5.382-6.229 2.22 0 4.618 1.551 4.618 5.003 0 3.907-3.627 8.47-10 12.629-6.373-4.159-10-8.722-10-12.629 0-3.484 2.369-5.005 4.577-5.005 3.923 0 5.145 5.126 5.423 6.231zm-12-1.226c0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-7.962-9.648-9.028-12-3.737-2.338-5.262-12-4.27-12 3.737z"/></svg>':svg.innerHTML='<svg id="fav" xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 24 24"><path d="M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"/></svg>',new LazyLoad,e.operating_hours&&fillRestaurantHoursHTML(),fetchReviewsFromURL()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");t.setAttribute("aria-label","opening hours of the restaurant"),t.classList.add("focus");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,r.setAttribute("tabindex",0),r.setAttribute("aria-label",`The opening hours in ${n}`),r.classList.add("focus"),a.appendChild(r);const i=document.createElement("td");i.innerHTML=e[n],i.setAttribute("tabindex",0),i.classList.add("focus"),a.appendChild(i),t.appendChild(a)}});const fillReviewsHTML=(e=self.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",n.setAttribute("tabindex",0),n.classList.add("focus"),t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)};createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,n.setAttribute("class","name"),t.setAttribute("tabindex",0),t.classList.add("focus"),t.setAttribute("aria-label",`Review from ${e.name}`),t.appendChild(n);const a=document.createElement("p");a.innerHTML=moment(e.createdAt).format("ddd, MMM Do YYYY"),a.setAttribute("class","date"),a.setAttribute("tabindex",0),a.classList.add("focus_white"),t.appendChild(a);const r=document.createElement("p");r.innerHTML=`Rating: ${e.rating}`,r.setAttribute("class","rating"),r.setAttribute("tabindex",0),r.classList.add("focus"),t.appendChild(r);const i=document.createElement("p");return i.innerHTML=e.comments,i.setAttribute("class","comments"),i.setAttribute("tabindex",0),i.classList.add("focus"),t.appendChild(i),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});let radioButtonValue="";function ratingTracker(e){radioButtonValue=e.value,document.getElementById("ratingSign").textContent=radioButtonValue+" points";for(let e=1;e<=5;e++){let t=document.getElementById(e);e<=radioButtonValue?t.classList.add("radioInputSpanBackground"):t.classList.remove("radioInputSpanBackground")}}function handleFavorite(e=self.restaurant){svg.innerHTML.includes("3.737z")?DBHelper.addRestaurantToFavorites(e.id,!0,(e,t)=>{svg.innerHTML='<svg id="fav" xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 24 24"><path d="M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"/></svg>'}):DBHelper.addRestaurantToFavorites(e.id,!1,(e,t)=>{svg.innerHTML='<svg id="fav" xmlns="http://www.w3.org/2000/svg" width="38" height="38" viewBox="0 0 24 24"><path d="M12 9.229c.234-1.12 1.547-6.229 5.382-6.229 2.22 0 4.618 1.551 4.618 5.003 0 3.907-3.627 8.47-10 12.629-6.373-4.159-10-8.722-10-12.629 0-3.484 2.369-5.005 4.577-5.005 3.923 0 5.145 5.126 5.423 6.231zm-12-1.226c0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-7.962-9.648-9.028-12-3.737-2.338-5.262-12-4.27-12 3.737z"/></svg>'})}svg.addEventListener("click",function(){handleFavorite()});let online_offline="";navigator.onLine?(online_offline=!0,console.log(online_offline)):(online_offline=!1,console.log(online_offline));let review="",name="",comment="",rating="",id="";window.addEventListener("offline",function(e){online_offline=!1,console.log(online_offline)},!1);const makeReview=(e=self.restaurant)=>{if(name=document.getElementById("nameInput").value,comment=document.getElementById("comment").value,rating=radioButtonValue,id=e.id,!0===online_offline)""!=name&&""!=comment&&(review={restaurant_id:id,name:name,rating:rating,comments:comment},fetch(DBHelper.DATABASE_URL+"/reviews",{method:"post",body:JSON.stringify(review)}).then(e=>e.json()).catch(e=>{console.log("Something went wrong submitting your review")}),window.location.reload());else if(console.log("Offline!"),""!=name&&""!=comment)return review={restaurant_id:id,name:name,rating:rating,comments:comment},!1};window.addEventListener("online",function(e){return online_offline=!0,""!=name&&""!=comment&&(fetch(DBHelper.DATABASE_URL+"/reviews",{method:"post",body:JSON.stringify(review)}).then(e=>e.json()).catch(e=>{console.log("Something went wrong submitting your review")}),window.location.reload()),!1});